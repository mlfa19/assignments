
%% Don't change any of these definitions.
\usepackage{graphicx}
\usepackage{listings}
\usepackage{xstring}
\usepackage{subfiles}
\usepackage{tikz,lmodern}
\usepackage{wrapfig}
\usepackage{pdfpages}

\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,
    urlcolor=cyan,
}
\usepackage{fontawesome}
\usepackage{enumerate}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{enumitem}
\usepackage[iso,american]{isodate}
\usepackage{fancyhdr}
\usepackage{todonotes}
\usepackage{xcolor}
\usepackage[tikz]{bclogo}
\usepackage{lipsum}
\usepackage{bm}
\usepackage[many]{tcolorbox}
\usepackage{cancel}

\usepackage{environ}

\setcounter{secnumdepth}{2}

%%
%% These definitions are meant to make your life easier. They provide shortcut commands for lots of common latex commands

\newcommand{\bi}{\begin{itemize}}
\newcommand{\ei}{\end{itemize}}
\newcommand{\be}{\begin{enumerate}}
\newcommand{\ee}{\end{enumerate}}
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}

% I am prepending ml to some of these commands to avoid namespace conflicts
\newcommand{\mlvec}[1]{\mathbf{#1}}
\newcommand{\mlmat}[1]{\mathbf{#1}}

\newcommand{\condindep}{\perp\!\!\!\perp}
\newcommand{\notcondindep}{~\cancel{\perp\!\!\!\perp}~}


\newcommand{\twobytwo}[4]{\ensuremath{\begin{bmatrix} #1 & #2 \\ #3 & #4\end{bmatrix}}}
\newcommand{\threebythree}[9]{\ensuremath{\begin{bmatrix} #1 & #2 & #3 \\ #4 & #5 & #6 \\ #7 & #8 & #9 \end{bmatrix}}}
\newcommand{\threebytwo}[6]{\ensuremath{\begin{bmatrix} #1 & #2  \\ #3 & #4  \\ #5 & #6  \end{bmatrix}}}

\newcommand{\onebytwo}[2]{\ensuremath{\begin{bmatrix} #1 & #2 \end{bmatrix}}}
\newcommand{\onebythree}[3]{\ensuremath{\begin{bmatrix} #1 & #2 & #3 \end{bmatrix}}}

\newcommand{\twobyone}[2]{\ensuremath{\begin{bmatrix} #1 \\ #2 \end{bmatrix}}}
\newcommand{\threebyone}[3]{\ensuremath{\begin{bmatrix} #1 \\ #2 \\ #3 \end{bmatrix}}}

\newcommand{\fourbyone}[4]{\ensuremath{\begin{bmatrix} #1 \\ #2 \\ #3 \\ #4 \end{bmatrix}}}

\newcommand{\That}{\hat{\mathbf{T}}}
\newcommand{\T}{\mathbf{T}}
\newcommand{\Nhat}{\hat{\mathbf{N}}}
\newcommand{\R}{\mathbf{R}}
\newcommand{\A}{\mathbf{A}}
\renewcommand{\L}{\mathbf{L}}
\newcommand{\M}{\mathbf{M}}
\newcommand{\Bhat}{\hat{\mathbf{B}}}
\renewcommand{\C}{\mathbf{C}}
\renewcommand{\S}{\mathbf{S}}
\renewcommand{\v}{\mathbf{v}}
\renewcommand{\t}{\mathbf{t}}
\renewcommand{\u}{\mathbf{u}}
\renewcommand{\r}{\mathbf{r}}
\renewcommand{\a}{\mathbf{a}}
\newcommand{\e}{\mathbf{e}}
\newcommand{\x}{\mathbf{x}}
\newcommand{\y}{\mathbf{y}}
\newcommand{\ihat}{\hat{\textbf{\i}}}
\newcommand{\jhat}{\hat{\textbf{\j}}}
\newcommand{\khat}{\hat{\mathbf{k}}}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}


%% these lines allow you to include / remove various parts of the TeX document
\newtoggle{solutions}


\newcommand{\iftoggleverb}[1]{%
  \ifcsdef{etb@tgl@#1}
    {\csname etb@tgl@#1\endcsname\iftrue\iffalse}
    {\etb@noglobal\etb@err@notoggle{#1}\iffalse}%
}


\newcommand{\solution}[1] {
\iftoggle{solutions}{

\textbf{Solution:}

#1
}

}


\newcommand{\companionnotebook}[1] {
\iftoggle{solutions}{
\includepdf[pages=1-]{#1_Solutions.pdf}
}{
\includepdf[pages=1-]{#1.pdf}
}

}

\sloppy


\lstset{basicstyle = \ttfamily,columns=fullflexible,upquote=true}

\newcommand{\bes}{\begin{enumerate}[label=(\alph*)]}
\newcommand{\ees}{\end{enumerate}}

\geometry{left=0.5in,top=1in,headsep=2\baselineskip,textwidth=33pc,marginparsep=1.5pc,marginparwidth=10pc,textheight=44\baselineskip,headheight=\baselineskip}

\newcommand{\invalidatemargin}{\newgeometry{left=0.5in,top=1in,headsep=2\baselineskip,textwidth=45pc,marginparsep=0pc,marginparwidth=0pc,textheight=44\baselineskip,headheight=\baselineskip}}

\NewEnviron{learningobjectives}{
\begin{tcolorbox}[breakable=true,parbox=false,enhanced,
  colback=white,colframe=magenta!20,title=\textcolor{black}{\faLightbulbO~Learning Objectives},fonttitle=\Large\bfseries]
  \BODY
\end{tcolorbox}
}


\NewEnviron{boxedsolution}{%
\iftoggleverb{solutions}
\begin{tcolorbox}[breakable=true,parbox=false,enhanced,
  colback=white,colframe=green!30,title=\textcolor{black}{\faStarO~Solution},fonttitle=\Large\bfseries]
  \BODY
\end{tcolorbox}
\fi}


\NewEnviron{priorknowledge}{
\begin{tcolorbox}[breakable=true,parbox=false,enhanced,
  colback=white,colframe=orange!50,title=\textcolor{black}{\faRetweet~Prior Knowledge Utilized},fonttitle=\Large\bfseries]
  \BODY
\end{tcolorbox}
}

\NewEnviron{externalresources}[1][]{
\ifstrempty{#1}{
\begin{tcolorbox}[breakable=true,parbox=false,enhanced,
  colback=white,colframe=pink!50,title=\textcolor{black}{\faExternalLink~External Resource(s)},fonttitle=\Large\bfseries]
  \BODY
\end{tcolorbox}
}{
\begin{tcolorbox}[breakable=true,parbox=false,enhanced,
  colback=white,colframe=pink!50,title=\textcolor{black}{\faExternalLink~External Resource(s)~#1},fonttitle=\Large\bfseries]
  \BODY
\end{tcolorbox}
}
}

\NewEnviron{recall}[1][]{%
\begin{tcolorbox}[breakable=true,parbox=false,enhanced,
  colback=white,colframe=brown!50,title=\textcolor{black}{\faRetweet~Recall:~#1},fonttitle=\Large\bfseries]
  \BODY
\end{tcolorbox}
}

\NewEnviron{correction}{
\begin{tcolorbox}[breakable=true,parbox=false,enhanced,
  colback=white,colframe=red!100,title=\textcolor{black}{\faClose~Correction},fonttitle=\Large\bfseries]
  \BODY
\end{tcolorbox}
}

\NewEnviron{understandingcheck}{
\begin{tcolorbox}[breakable=true,parbox=false,enhanced,
  colback=white,colframe=purple!40,title=\textcolor{black}{\faCheck~Understanding Check},fonttitle=\Large\bfseries]
  \BODY
\end{tcolorbox}}

\NewEnviron{notice}{
\begin{tcolorbox}[breakable=true,parbox=false,enhanced,
  colback=white,colframe=yellow!100,title=\textcolor{black}{\faWarning~Notice},fonttitle=\Large\bfseries]
  \BODY
\end{tcolorbox}}


\newcounter{exercise}
\NewEnviron{exercise}[1][]{%
\stepcounter{exercise}%
  \ifstrempty{#1}%
  {
\begin{tcolorbox}[breakable=true,parbox=false,enhanced,
  colback=white,colframe=blue!20,title=\textcolor{black}{Exercise~\theexercise},fonttitle=\Large\bfseries]
  \BODY
\end{tcolorbox}
  }{
\begin{tcolorbox}[breakable=true,enhanced,
  colback=white,colframe=blue!20,title=\textcolor{black}{Exercise~\theexercise~#1},fonttitle=\Large\bfseries]
  \BODY
\end{tcolorbox}
  }
}


% use package marginnote, which overrides the Tufte marginnote package.  This will allow us to use marginnotes within boxes.  It apparently will not carry over some of the Tufte settings though (https://tex.stackexchange.com/questions/412127/how-to-use-marginnote-in-mdframed-environment-follow-up)
%\let\marginnote\someundefinedcommand
%\usepackage{marginnote}

